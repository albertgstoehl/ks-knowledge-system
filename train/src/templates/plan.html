{% extends "base.html" %}
{% import "components.html" as ui %}

{% block content %}
<div class="p-md">
  <div id="plan-container" class="markdown-content">
    Loading plan...
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
async function loadPlan() {
  try {
    const resp = await fetch(`${basePath}/api/plan/current`);
    if (!resp.ok) {
      document.getElementById('plan-container').innerHTML = 
        '<p class="text-muted">No plan registered yet.</p>';
      return;
    }
    const data = await resp.json();
    const html = marked.parse(data.markdown);
    document.getElementById('plan-container').innerHTML = html;
  } catch (e) {
    document.getElementById('plan-container').innerHTML = 
      '<p class="text-danger">Error loading plan</p>';
  }
}

loadPlan();
</script>
{% endblock %}
